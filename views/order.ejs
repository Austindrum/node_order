<%- include("./partials/header"); %>
<% if(ordersDate){ %>
    <% ordersDate.forEach(date=>{ %>
        <div style="display: none;" class="date-order" data-orderDate="<%= date %>"></div>
    <% }) %>  
<% } %>  
<div class="container order">
    <form 
    <% if(orderedInfo.length > 0){ %>
        action="/order?_method=PUT" method="POST"
    <% }else{ %>
        action="/order" method="POST"
    <% } %>>
        <% if(orderedInfo.length > 0){ %>
            <input 
            type="text"
            style="display: none;"
            name="orderId"
            value="<%= orderedInfo[0].id %>">
        <% } %>
        <input
        style="display: none;" 
        class="target-date" 
        data-date="<%= date %>"
        name="date"
        value="<%= date %>">
        <div class="info-block">
            <i class="fas fa-user fa-lg"></i>
            <p><strong>ID</strong></p>
            <span class="user-id"><%= user.work_id %></span>
        </div>
        <div class="info-block">
            <i class="fas fa-coffee fa-lg"></i>
            <p><strong>Breakfast</strong></p>
            <select name="breakfast" <%= overTime.breakfast ? "disabled" : "" %>>
                <option value="">select..</option>
                <% meals.forEach(e => { %>
                    <% if(e.type === "b"){ %>
                        <option value="<%= e.id %>"
                        <% if(orderedInfo.length > 0){ %>
                            <% orderedInfo[0].meal.forEach(data => { %>
                                <% if(data.id === e.id) { %>
                                    selected 
                                <% } %>
                            <% }); %>
                        <% } %>
                        ><%= e.name %></option>
                    <% } %>
                <% }) %>
            </select>
        </div>
        <div class="info-block">
            <i class="fas fa-utensils fa-lg"></i>
            <p><strong>Dinner</strong></p>
            <select name="dinner" <%= overTime.dinner ? "disabled" : "" %>>
                <option value="">select..</option>
                <% meals.forEach(e => { %>
                    <% if(e.type === "d"){ %>
                        <option value="<%= e.id %>"
                        <% if(orderedInfo.length > 0){ %>
                            <% orderedInfo[0].meal.forEach(data => { %>
                                <% if(data.id === e.id) { %>
                                    selected 
                                <% } %>
                            <% }); %>
                        <% } %>
                        ><%= e.name %></option>
                    <% } %>
                <% }) %>
            </select>
        </div>
        <div class="info-block">
            <i class="fas fa-moon fa-lg"></i>
            <p><strong>Midnight</strong></p>
            <select name="midnight" <%= overTime.midnight ? "disabled" : "" %>>
                <option value="">select..</option>
                <% meals.forEach(e => { %>
                    <% if(e.type === "m"){ %>
                        <option value="<%= e.id %>"
                        <% if(orderedInfo.length > 0){ %>
                            <% orderedInfo[0].meal.forEach(data => { %>
                                <% if(data.id === e.id) { %>
                                    selected 
                                <% } %>
                            <% }); %>
                        <% } %>
                        ><%= e.name %></option>
                    <% } %>
                <% }) %>
            </select>
        </div>
        <% if(overTime.breakfast && overTime.dinner && overTime.midnight){ %>
            <div style="margin-top: 2rem;">
                <p style="text-align: center; font-weight: 700; font-size: 2rem;">Order End</p>
            </div>
        <% }else{ %>
            <input type="submit"
            <% if(orderedInfo.length > 0){ %>
            value="Edit"
            class="edit"
            <% }else{ %>
            value="Submit"
            class="submit"
            <% } %>
            >
        <% } %>
    </form>
    <% if(orderedInfo.length > 0){ %>
    <form action="/order?_method=DELETE" method="POST">
        <input 
        type="text"
        style="display: none;"
        name="orderId"
        value="<%= orderedInfo[0].id %>">
        <input
        style="display: none;" 
        class="target-date" 
        data-date="<%= date %>"
        name="date"
        value="<%= date %>">
        <input type="submit" class="delete" value="Delete" onclick="return confirm('Are you sure you want to delete this item?');">
    </form>
    <% } %>
    <div class="calendar-wrapper">
        <button id="btnPrev" type="button">Prev</button>
        <button id="btnNext" type="button">Next</button>
        <div id="divCal">
        </div>
    </div>
</div>
<script src="/calendar.js"></script>
<%- include("./partials/footer"); %>
